Data2 <- read.csv("data2.csv")
Data2$date<-as.Date(Data2$date,'%d/%m/%Y')
Data <- read.csv("polling data.csv")
Data$ï..date<-as.Date(Data$ï..date,'%d/%m/%Y')
library(ggplot2)
library(bbplot)
library(scales)
library(tidyquant)
library(quantmod)
library(TTR)
attach(Data2)
ggplot(Data2, aes(x=date, y=vote,colour=party, group=party))+
geom_smooth(method="lm",formula =y ~ poly(x, 24),fullrange=FALSE,size=1,se=TRUE)+
geom_point(aes(color=party,group=party),alpha=1,size=1 )+ scale_color_manual(values = c("#0087DC","#6AB023","#E4003B","#FAA61A","#FDF38E"))+
scale_x_date(date_labels="%m/%y",date_breaks  ="1 month")+
scale_y_continuous(labels = function(y) scales::percent(y, accuracy = 1))+
theme(axis.text.x = element_text(size=10,angle = 90, vjust = 0.5, hjust=1))+
theme(panel.grid.minor.x = element_line(color = "#DADADA",size = 0.05,linetype = 1),panel.grid.minor.y = element_line(color = "#DADADA",size = 0.05,linetype = 1),panel.grid.major.y= element_line(color = "#DADADA",size = 0.05,linetype = 1))+
labs(title = "Opinion polling for the next United Kingdom general election (poly)",subtitle  = "@LinkseRadicaal")+
bbc_style()
library(ggplot2)
library(bbplot)
library(scales)
library(tidyquant)
library(quantmod)
library(TTR)
attach(Data2)
ggplot(Data2, aes(x=date, y=vote,colour=party, group=party))+
geom_smooth(method="loess",fullrange=FALSE,size=1)+
geom_point(aes(color=party,group=party), size = 1,alpha=1 )+ scale_color_manual(values = c("#0087DC","#6AB023","#E4003B","#FAA61A","#FDF38E"))+
scale_x_date(date_labels="%m/%y",date_breaks  ="1 month")+
scale_y_continuous(labels = function(y) scales::percent(y, accuracy = 1))+
theme(axis.text.x = element_text(size=10,angle = 90, vjust = 0.5, hjust=1))+
theme(panel.grid.minor.x = element_line(color = "#DADADA",size = 0.05,linetype = 1),panel.grid.minor.y = element_line(color = "#DADADA",size = 0.05,linetype = 1),panel.grid.major.y= element_line(color = "#DADADA",size = 0.05,linetype = 1))+
labs(title = "Opinion polling for the next United Kingdom general election (LOESS)",subtitle  = "@LinkseRadicaal")+
bbc_style()
#geom_ma(ma_fun = EMA, n = 10, size = 1)
library(ggplot2)
library(bbplot)
library(scales)
library(tidyquant)
library(quantmod)
library(TTR)
attach(Data2)
ggplot(Data2, aes(x=date, y=vote,colour=party, group=party))+
geom_smooth(method="lm",formula =y ~ poly(x, 24),fullrange=FALSE,size=1,se=TRUE)+
geom_point(aes(color=party,group=party),alpha=1,size=1 )+ scale_color_manual(values = c("#0087DC","#6AB023","#E4003B","#FAA61A","#FDF38E"))+
scale_x_date(date_labels="%m/%y",date_breaks  ="1 month")+
scale_y_continuous(labels = function(y) scales::percent(y, accuracy = 1))+
theme(axis.text.x = element_text(size=10,angle = 90, vjust = 0.5, hjust=1))+
theme(panel.grid.minor.x = element_line(color = "#DADADA",size = 0.05,linetype = 1),panel.grid.minor.y = element_line(color = "#DADADA",size = 0.05,linetype = 1),panel.grid.major.y= element_line(color = "#DADADA",size = 0.05,linetype = 1))+
labs(title = "Opinion polling for the next United Kingdom general election (poly)",subtitle  = "@LinkseRadicaal")+
bbc_style()
ggplot(Data2, aes(x=date, y=vote,colour=party, group=party))+
geom_smooth(method="loess",fullrange=FALSE,size=1)+
geom_point(aes(color=party,group=party), size = 1,alpha=1 )+ scale_color_manual(values = c("#0087DC","#6AB023","#E4003B","#FAA61A","#FDF38E"))+
scale_x_date(date_labels="%m/%y",date_breaks  ="1 month")+
scale_y_continuous(labels = function(y) scales::percent(y, accuracy = 1))+
theme(axis.text.x = element_text(size=10,angle = 90, vjust = 0.5, hjust=1))+
theme(panel.grid.minor.x = element_line(color = "#DADADA",size = 0.05,linetype = 1),panel.grid.minor.y = element_line(color = "#DADADA",size = 0.05,linetype = 1),panel.grid.major.y= element_line(color = "#DADADA",size = 0.05,linetype = 1))+
labs(title = "Opinion polling for the next United Kingdom general election (LOESS)",subtitle  = "@LinkseRadicaal")+
bbc_style()
Data <- read.csv("polling data.csv")
Data$ï..date<-as.Date(Data$ï..date,'%d/%m/%Y')
library(ggplot2)
library(bbplot)
library(scales)
library(tidyquant)
library(quantmod)
library(TTR)
attach(Data)
ggplot(Data, aes(x=ï..date, y=vote,colour=party, group=party))+
geom_smooth(method="loess",fullrange=FALSE,size=1)+
geom_point(aes(color=party,group=party), size = 0.25,alpha=1 )+ scale_color_manual(values = c("#0087DC","#6AB023","#E4003B","#FAA61A","#FDF38E"))+
scale_x_date(date_labels="%m/%y",date_breaks  ="1 month")+
scale_y_continuous(labels = function(y) scales::percent(y, accuracy = 1))+
theme(axis.text.x = element_text(size=10,angle = 90, vjust = 0.5, hjust=1))+
theme(panel.grid.minor.x = element_line(color = "#DADADA",size = 0.05,linetype = 1),panel.grid.minor.y = element_line(color = "#DADADA",size = 0.05,linetype = 1),panel.grid.major.y= element_line(color = "#DADADA",size = 0.05,linetype = 1))+
#geom_ma(ma_fun = EMA, n = 10, size = 1)+
bbc_style()
setwd("C:/Users/harvi/Desktop/Random Stuff/Polling/Polling")
library(readr)
poll <- read_csv("poll2.csv")
library(reshape2)
d <- melt(poll, id.vars="Date")
d$Date<-as.Date(d$Date, "%d/%m/%Y")
library(formattable)
d$value<-formattable::percent(d$value)
library(ggplot2)
library(bbplot)
library(tidyquant)
library(scales)
# TWITTER GRAPH
ggplot(data=d,aes(x=Date,y=value, colour=variable, group=variable)) +
geom_point(size=0.5) +
scale_color_manual(values = c("#0087DC","#E4003B","#FAA61A","#FDF38E","#528D6B"))+
bbplot::bbc_style()+
scale_y_continuous(name="Vote",labels = formattable::percent,breaks=seq(0,0.6,0.05))+
geom_ma(ma_fun=EMA, n = 5,linetype="solid",size=0.75,wilder=TRUE)
